<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>LAN Devices — ICEtag</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  :root { color-scheme: dark; }
  body { font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; background: #0f172a; color:#e2e8f0; margin:0; }
  .wrap { max-width: 1200px; margin: 32px auto; padding: 0 16px; }
  .card { background:#0b1220; border:1px solid #1f2a44; border-radius:16px; padding:20px; box-shadow: 0 10px 30px rgba(0,0,0,.25); }
  h1 { margin:0 0 12px 0; font-size: 28px; }
  a { color:#60a5fa; text-decoration:none; }
  a:hover { text-decoration:underline; }
  table { width:100%; border-collapse: collapse; }
  th, td { text-align:left; padding:8px 10px; border-bottom:1px solid #1f2a44; }
  th { position: sticky; top:0; background:#0a0f1b; }
  .toolbar { display:flex; gap:12px; align-items:center; margin-bottom:12px; }
  button { background:#334155; color:white; padding:8px 12px; border:none; border-radius:10px; font-weight:700; cursor:pointer; }
  .pill { display:inline-block; background:#1e293b; border:1px solid #334155; border-radius:999px; padding:4px 10px; font-weight:600; }
</style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <div class="toolbar">
      <a href="/" class="pill">← Back</a>
      <h1 style="margin-left:8px;">LAN Devices</h1>
      <span id="count" class="pill" style="margin-left:auto;">0 devices</span>
      <button id="refresh">Refresh</button>
    </div>
    <div style="overflow:auto; max-height:70vh;">
      <table id="tbl">
        <thead>
          <tr>
            <th>Last Seen</th>
            <th>IP</th>
            <th>MAC</th>
            <th>Vendor</th>
            <th>Interface</th>
            <th>Host (scanner)</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>
</div>
<script>
const tbody = document.querySelector("#tbl tbody");
const count = document.getElementById("count");
async function load() {
  const r = await fetch("/lan.json");
  const j = await r.json();
  const rows = j.items || [];
  tbody.innerHTML = "";
  for (const d of rows) {
    const tr = document.createElement("tr");
    tr.innerHTML = `<td>${d.last_seen ?? ""}</td>
                    <td>${d.ip ?? ""}</td>
                    <td>${d.mac ?? ""}</td>
                    <td>${d.vendor ?? ""}</td>
                    <td>${d.iface ?? ""}</td>
                    <td>${d.host ?? ""}</td>`;
    tbody.appendChild(tr);
  }
  count.textContent = `${rows.length} device${rows.length==1?"":"s"}`;
}
document.getElementById("refresh").addEventListener("click", load);
load();
</script>
</body>
</html>